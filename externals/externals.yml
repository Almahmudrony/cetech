######
# bx #
########################################################################################################################
bx:
  platforms: [linux64, darwin64, windows64]
  clone: git clone https://github.com/bkaradzic/bx --depth 1

  install:
    includes: &bx_install_include
      [include/bx, release/include/bx]

    linux64:
      - copytree: *bx_install_include

    windows64:
      - copytree: *bx_install_include

    darwin64:
      - copytree: *bx_install_include

########
# bgfx #
########################################################################################################################
bgfx:
  platforms: [linux64, darwin64, windows64]
  clone: git clone https://github.com/bkaradzic/bgfx --depth 1

  build:
    linux64:
      - make linux-release64
      - make linux-debug64

    darwin64:
      - make osx-release64
      - make osx-debug64

    windows64:
      - ../bx/tools/bin/windows/genie --with-tools --with-shared-lib vs2015
      - devenv .build/projects/vs2015/bgfx.sln /Build Debug|x64
      - devenv .build/projects/vs2015/bgfx.sln /Build Release|x64

  install:
    includes: &bgfx_install_include
      [include/bgfx, release/include/bgfx]

    linux64:
      - copytree: *bgfx_install_include
      - copyfile: [.build/linux64_gcc/bin/libbgfxRelease.a, release/lib/libbgfxRelease.a]
      - copyfile: [.build/linux64_gcc/bin/libbgfxDebug.a, debug/lib/libbgfxDebug.a]
      - copyfile: [.build/linux64_gcc/bin/shadercRelease, release/bin/shaderc]
      - copyfile: [.build/linux64_gcc/bin/texturecRelease, release/bin/texturec]

    darwin64:
      - copytree: *bgfx_install_include
      - copyfile: [.build/osx64_clang/bin/libbgfxRelease.a, release/lib/libbgfxRelease.a]
      - copyfile: [.build/osx64_clang/bin/libbgfxDebug.a, debug/lib/libbgfxDebug.a]
      - copyfile: [.build/osx64_clang/bin/shadercRelease, release/bin/shaderc]
      - copyfile: [.build/osx64_clang/bin/texturecRelease, release/bin/texturec]

    windows64:
      - copytree: *bgfx_install_include
      - copyfile: [.build/win64_vs2015/bin/bgfx-shared-libRelease.lib, release/lib/bgfxRelease.lib]
      - copyfile: [.build/win64_vs2015/bin/bgfx-shared-libDebug.lib, debug/lib/bgfxDebug.lib]
      - copyfile: [.build/win64_vs2015/bin/shadercRelease.exe, release/bin/shaderc.exe]
      - copyfile: [.build/win64_vs2015/bin/texturecRelease.exe, release/bin/texturec.exe]


########
# SLD2 #
########################################################################################################################
sdl2:
  platforms: [linux64, darwin64]
  clone: git clone https://github.com/spurious/SDL-mirror.git --depth 1

  build:
    configure: &sdl2_build_configure
      - ./configure --disable-video-wayland
      - make

    configure_darwin: &sdl2_build_configure_darwin
      [./configure --with-x=no, make]

    linux64:  *sdl2_build_configure
    darwin64: *sdl2_build_configure_darwin

  install:
    lib: &sdl2_install_lib
      [build/.libs/libSDL2.a, release/lib/libSDL2.a]

    linux64:
      - copyfile: [build/.libs/libSDL2.a, release/lib/libSDL2.a]
      - copytree: [include, release/include/SDL2]
      - copyfile: [build/.libs/libSDL2.a, debug/lib/libSDL2.a]
      - copytree: [include, debug/include/SDL2]

    darwin64:
      - copyfile: [build/.libs/libSDL2.a, release/lib/libSDL2.a]
      - copytree: [include, release/include/SDL2]
      - copyfile: [build/.libs/libSDL2.a, debug/lib/libSDL2.a]
      - copytree: [include, debug/include/SDL2]
########
# SLD2 #
########################################################################################################################
sdl2_win_bin:
  platforms: windows64
  clone: download https://www.libsdl.org/release/SDL2-2.0.4-win32-x64.zip SDL2-2.0.4-win32-x64.zip

  build:
    windows64: extract SDL2-2.0.4-win32-x64.zip

  install:
     windows64:
      - copy: [SDL2.dll, release\lib]

###########
# nanomsg #
########################################################################################################################
nanomsg:
  clone: git clone https://github.com/nanomsg/nanomsg.git --depth 1

  build:
    posix: &nanomsg_build_posix
      [cmake . -DNN_STATIC_LIB=TRUE, make]

    linux64:  *nanomsg_build_posix
    darwin64: *nanomsg_build_posix
    windows64:
      - cmake .
      - devenv nanomsg.sln /build release

  install:
    linux64:
      - copyfile: [libnanomsg.a, release/lib/libnanomsg.a]
      - copytree: [src, release/include/nanomsg]

      - copyfile: [libnanomsg.a, debug/lib/libnanomsg.a]
      - copytree: [src, debug/include/nanomsg]

    darwin64:
      - copyfile: [libnanomsg.a, release/lib/libnanomsg.a]
      - copytree: [src, release/include/nanomsg]

      - copyfile: [libnanomsg.a, debug/lib/libnanomsg.a]
      - copytree: [src, debug/include/nanomsg]

    windows64:
      - copy: [Release\nanomsg.dll, release/lib]
      - copytree: [src, release/include/nanomsg]

      - copy: [Release\nanomsg.dll, debug/lib]
      - copytree: [src, debug/include/nanomsg]


##########
# assimp #
########################################################################################################################
assimp:
  platforms: [linux64, windows64]
  clone: git clone https://github.com/assimp/assimp.git --depth 1

  build:
    linux64:
      - cmake . -DBUILD_SHARED_LIBS=FALSE -DASSIMP_BUILD_TESTS=FALSE
      - make

    windows64:
      - cmake . -DBUILD_SHARED_LIBS=FALSE -DASSIMP_BUILD_TESTS=FALSE
      - devenv assimp.sln /build release

  install:
     linux64:
      - copyfile: [lib/libassimp.a, release/lib/libassimp.a]
      - copytree: [include/assimp, release/include/assimp]

     windows64:
      - copyfile: [lib/release/assimp.lib, release/lib/assimp.lib]
      - copyfile: [lib/release/zlibstatic.lib, release/lib/zlibstatic.lib]
      - copytree: [include/assimp, release/include/assimp]

#########
# catch #
########################################################################################################################
catch:
  clone: git clone https://github.com/philsquared/Catch.git --depth 1

  install:
    includes_relese: &catch_install_include_release
      [single_include/catch.hpp, release/include/catch]

    includes_debug: &catch_install_include_debug
      [single_include/catch.hpp, debug/include/catch]

    linux64:
      - copy: *catch_install_include_release
      - copy: *catch_install_include_debug

    windows64:
      - copy: *catch_install_include_release
      - copy: *catch_install_include_debug

    darwin64:
      - copy: *catch_install_include_release
      - copy: *catch_install_include_debug

#########
# MPack #
########################################################################################################################
mpack:
  clone: git clone https://github.com/ludocode/mpack.git --depth 1

  install:
    linux64:
      - copytree: [src/mpack, release/include/mpack]
      - copyfile: [src/mpack-config.h.sample, release/include/mpack/mpack-config.h.sample]

      - copytree: [src/mpack, debug/include/mpack]
      - copyfile: [src/mpack-config.h.sample, debug/include/mpack/mpack-config.h.sample]

    windows64:
      - copytree: [src/mpack, release/include/mpack]
      - copyfile: [src/mpack-config.h.sample, release/include/mpack/mpack-config.h.sample]

      - copytree: [src/mpack, debug/include/mpack]
      - copyfile: [src/mpack-config.h.sample, debug/include/mpack/mpack-config.h.sample]


    darwin64:
      - copytree: [src/mpack, release/include/mpack]
      - copyfile: [src/mpack-config.h.sample, release/include/mpack/mpack-config.h.sample]

      - copytree: [src/mpack, debug/include/mpack]
      - copyfile: [src/mpack-config.h.sample, debug/include/mpack/mpack-config.h.sample]

############
# yaml-cpp #
########################################################################################################################
yaml-cpp:
  platforms: [linux64]
  clone: git clone https://github.com/jbeder/yaml-cpp.git --depth 1

  build:
    linux64:
      - cmake .
      - make

  install:
     linux64:
      - copyfile: [libyaml-cpp.a, release/lib/libyaml-cpp.a]
      - copytree: [include/yaml-cpp, release/include/yaml-cpp]

      - copyfile: [libyaml-cpp.a, debug/lib/libyaml-cpp.a]
      - copytree: [include/yaml-cpp, debug/include/yaml-cpp]


##########
# luajit #
########################################################################################################################
luajit:
  clone: git clone http://luajit.org/git/luajit-2.0.git

  build:
    linux64:  make
    linux32:  make
    darwin64: make

  install:
    linux64:
      - copy: [src/libluajit.a, release/lib]
      - copy: [src/lauxlib.h, release/include/luajit]
      - copy: [src/luaconf.h, release/include/luajit]
      - copy: [src/lua.h, release/include/luajit]
      - copy: [src/lua.hpp, release/include/luajit]
      - copy: [src/luajit.h, release/include/luajit]
      - copy: [src/lualib.h, release/include/luajit]

      - copy: [src/libluajit.a, debug/lib]
      - copy: [src/lauxlib.h, debug/include/luajit]
      - copy: [src/luaconf.h, debug/include/luajit]
      - copy: [src/lua.h, debug/include/luajit]
      - copy: [src/lua.hpp, debug/include/luajit]
      - copy: [src/luajit.h, debug/include/luajit]
      - copy: [src/lualib.h, debug/include/luajit]

    darwin64:
      - copy: [src/libluajit.a, release/lib]
      - copy: [src/lauxlib.h, release/include/luajit]
      - copy: [src/luaconf.h, release/include/luajit]
      - copy: [src/lua.h, release/include/luajit]
      - copy: [src/lua.hpp, release/include/luajit]
      - copy: [src/luajit.h, release/include/luajit]
      - copy: [src/lualib.h, release/include/luajit]

      - copy: [src/libluajit.a, debug/lib]
      - copy: [src/lauxlib.h, debug/include/luajit]
      - copy: [src/luaconf.h, debug/include/luajit]
      - copy: [src/lua.h, debug/include/luajit]
      - copy: [src/lua.hpp, debug/include/luajit]
      - copy: [src/luajit.h, debug/include/luajit]
      - copy: [src/lualib.h, debug/include/luajit]

###########
# sqlite3 #
########################################################################################################################
sqlite3:
  clone:
    - git clone https://github.com/mackyle/sqlite --depth 1
    - download http://repo.or.cz/sqlite-export.git/blob_plain/master:/create-fossil-manifest create-fossil-manifest.sh

  build:
    posix: &sqlite3_build_posix
      - /bin/sh ./create-fossil-manifest.sh
      - ./configure
      - make

    linux64:  *sqlite3_build_posix
    linux32:  *sqlite3_build_posix
    darwin64: *sqlite3_build_posix

  install:
    linux64:
      - copy: [sqlite3.h, release/include/sqlite3]
      - copy: [.libs/libsqlite3.a, release/lib]
      - copy: [sqlite3.h, debug/include/sqlite3]
      - copy: [.libs/libsqlite3.a, debug/lib]

    linux32:
      - copy: [sqlite3.h, release/include/sqlite3]
      - copy: [.libs/libsqlite3.a, release/lib]
      - copy: [sqlite3.h, debug/include/sqlite3]
      - copy: [.libs/libsqlite3.a, debug/lib]

    darwin64:
      - copy: [sqlite3.h, release/include/sqlite3]
      - copy: [.libs/libsqlite3.a, release/lib]
      - copy: [sqlite3.h, debug/include/sqlite3]
      - copy: [.libs/libsqlite3.a, debug/lib]

