######
# bx #
########################################################################################################################
bx:
  platforms: [linux64, darwin64]
  clone: git clone https://github.com/bkaradzic/bx --depth 1

  install:
    includes: &bx_install_include
      [include/bx, release/include/bx]

    linux64:
      - copytree: *bx_install_include

    darwin64:
      - copytree: *bx_install_include

########
# bgfx #
########################################################################################################################
bgfx:
  platforms: [linux64, darwin64]
  clone: git clone https://github.com/bkaradzic/bgfx --depth 1

  build:
    linux64:
      - make linux-release64
      - make linux-debug64

    darwin64:
      - make osx-release64
      - make osx-debug64

  install:
    includes: &bgfx_install_include
      [include/bgfx, release/include/bgfx]

    linux64:
      - copytree: *bgfx_install_include
      - copyfile: [.build/linux64_gcc/bin/libbgfxRelease.a, release/lib/libbgfxRelease.a]
      - copyfile: [.build/linux64_gcc/bin/libbgfxDebug.a, debug/lib/libbgfxDebug.a]
      - copyfile: [.build/linux64_gcc/bin/shadercRelease, release/bin/shaderc]
      - copyfile: [.build/linux64_gcc/bin/texturecRelease, release/bin/texturec]

    darwin64:
      - copytree: *bgfx_install_include
      - copyfile: [.build/osx64_clang/bin/libbgfxRelease.a, release/lib/libbgfxRelease.a]
      - copyfile: [.build/osx64_clang/bin/libbgfxDebug.a, debug/lib/libbgfxDebug.a]
      - copyfile: [.build/osx64_clang/bin/shadercRelease, release/bin/shaderc]
      - copyfile: [.build/osx64_clang/bin/texturecRelease, release/bin/texturec]

########
# SLD2 #
########################################################################################################################
sdl2:
  platforms: [linux64, darwin64]
  clone: git clone https://github.com/spurious/SDL-mirror.git --depth 1

  build:
    configure: &sdl2_build_configure
      - ./configure --disable-video-wayland
      - make

    configure_darwin: &sdl2_build_configure_darwin
      [./configure --with-x=no, make]

    linux64:  *sdl2_build_configure
    darwin64: *sdl2_build_configure_darwin

  install:
    lib: &sdl2_install_lib
      [build/.libs/libSDL2.a, release/lib/libSDL2.a]

    linux64:
      - copyfile: *sdl2_install_lib
      - copytree: [include, release/include/SDL2]

    darwin64:
      - copyfile: *sdl2_install_lib
      - copytree: [include, release/include/SDL2]

########
# SLD2 #
########################################################################################################################
sdl2_win_bin:
  platforms: windows64
  clone: download https://www.libsdl.org/release/SDL2-2.0.4-win32-x64.zip SDL2-2.0.4-win32-x64.zip

  build:
    windows64: extract SDL2-2.0.4-win32-x64.zip

  install:
     windows64:
      - copy: [SDL2.dll, release\lib]

###########
# nanomsg #
########################################################################################################################
nanomsg:
  clone: git clone https://github.com/nanomsg/nanomsg.git --depth 1

  build:
    posix: &nanomsg_build_posix
      [cmake . -DNN_STATIC_LIB=TRUE, make]

    linux64:  *nanomsg_build_posix
    darwin64: *nanomsg_build_posix
    windows64:
      - cmake . -DNN_STATIC_LIB=TRUE
      - devenv nanomsg.sln /build release

  install:
    linux64:
      - copyfile: [libnanomsg.a, release/lib/libnanomsg.a]
      - copytree: [src, release/include/nanomsg]

    darwin64:
      - copyfile: [libnanomsg.a, release/lib/libnanomsg.a]
      - copytree: [src, release/include/nanomsg]

    windows64:
      - copy: [release\nanomsg.dll, release/lib]
      - copytree: [src, release/include/nanomsg]


##########
# assimp #
########################################################################################################################
assimp:
  platforms: [linux64, darwin64]
  clone: git clone https://github.com/assimp/assimp.git --depth 1

  build:
    linux64:
      - cmake . -DBUILD_SHARED_LIBS=FALSE -DASSIMP_BUILD_TESTS=FALSE
      - make

  install:
     linux64:
      - copyfile: [lib/libassimp.a, release/lib/libassimp.a]
      - copytree: [include/assimp, release/include/assimp]

#########
# catch #
########################################################################################################################
catch:
  clone: git clone https://github.com/philsquared/Catch.git --depth 1

  install:
    includes: &catch_install_include
      [single_include/catch.hpp, release/include/catch]

    linux64:
      - copy: *catch_install_include

    linux32:
      - copy: *catch_install_include

    darwin64:
      - copy: *catch_install_include

#########
# MPack #
########################################################################################################################
mpack:
  clone: git clone https://github.com/ludocode/mpack.git --depth 1

  install:
    linux64:
      - copytree: [src/mpack, release/include/mpack]
      - copyfile: [src/mpack-config.h.sample, release/include/mpack/mpack-config.h.sample]

    darwin64:
      - copytree: [src/mpack, include/mpack]
      - copyfile: [src/mpack-config.h.sample, release/include/mpack/mpack-config.h.sample]