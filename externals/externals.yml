######
# bx #
########################################################################################################################
bx:
  platforms: [linux64, darwin64]
  clone: git clone https://github.com/bkaradzic/bx --depth 1

  install:
    includes: &bx_install_include
      [include/bx, include/bx]

    linux64:
      - copytree: *bx_install_include

    darwin64:
      - copytree: *bx_install_include

########
# bgfx #
########################################################################################################################
bgfx:
  platforms: [linux64, darwin64]
  clone: git clone https://github.com/bkaradzic/bgfx --depth 1

  build:
    linux64:
      - make linux-release64
      - make linux-debug64

    darwin64:
      - make osx-release64
      - make osx-debug64

  install:
    linux64:
      - copyfile: [.build/linux64_gcc/bin/libbgfx-shared-libRelease.so, Release/lib/bgfx.so]
      - copyfile: [.build/linux64_gcc/bin/libbgfx-shared-libDebug.so, Debug/lib/bgfx_debug.so]

    darwin64:
      - copyfile: [.build/osx64_clang/bin/libbgfxRelease.a, lib]

#############
# SharpBGFX #
########################################################################################################################
sharp-bgfx:
  clone: git clone https://github.com/OndraVoves/SharpBgfx.git --depth 1

  build:
    windows64:
      - devenv SharpBgfx/SharpBgfx.csproj /build Debug
      - devenv SharpBgfx/SharpBgfx.csproj /build Release

    linux64:
      - xbuild /p:Configuration=Debug SharpBgfx/SharpBgfx.csproj
      - xbuild /p:Configuration=Release SharpBgfx/SharpBgfx.csproj

  install:
     windows64:
      - copytree: [SharpBgfx\bin\Debug, Debug\lib]
      - copytree: [SharpBgfx\bin\Release, Release\lib]
      - copy: [tools\shaderc.exe, Release\bin]
      - copy: [tools\texturec.exe, Release\bin]

     linux64:
      - copytree: [SharpBgfx/bin/Debug, Debug/lib]
      - copytree: [SharpBgfx/bin/Release, Release/lib]

#############
# MoonSharp #
########################################################################################################################
moonsharp:
  clone: git clone https://github.com/xanathar/moonsharp.git --depth 1

  build:
    windows64:
      - devenv src\MoonSharp.Interpreter\MoonSharp.Interpreter.net35-client.csproj /build Debug
      - devenv src\MoonSharp.Interpreter\MoonSharp.Interpreter.net35-client.csproj /build Release

    linux64:
      - xbuild /p:TargetFrameworkVersion=v4.0 /p:Configuration=Debug src/MoonSharp.Interpreter/MoonSharp.Interpreter.net35-client.csproj
      - xbuild /p:TargetFrameworkVersion=v4.0 /p:Configuration=Release src/MoonSharp.Interpreter/MoonSharp.Interpreter.net35-client.csproj

  install:
    windows64:
      - copytree: [src\MoonSharp.Interpreter\bin\Debug, Debug\lib]
      - copytree: [src\MoonSharp.Interpreter\bin\Release, Release\lib]

    linux64:
      - copytree: [src/MoonSharp.Interpreter/bin/Debug, Debug/lib]
      - copytree: [src/MoonSharp.Interpreter/bin/Release, Release/lib]

###########
# SDL2-CS #
########################################################################################################################
sdl2-cs:
  clone: git clone https://github.com/flibitijibibo/SDL2-CS.git --depth 1

  build:
    windows64:
      - devenv SDL2-CS.csproj /build Debug
      - devenv SDL2-CS.csproj /build Release

    linux64:
      - xbuild /p:Configuration=Debug SDL2-CS.csproj
      - xbuild /p:Configuration=Release SDL2-CS.csproj


  install:
     windows64:
      - copytree: [bin\Debug, Debug\lib]
      - copytree: [bin\Release, Release\lib]

     linux64:
      - copytree: [bin/Debug, Debug/lib]
      - copytree: [bin/Release, Release/lib]


##############
# YamlDotNet #
########################################################################################################################
yamldotnet:
  clone: git clone https://github.com/aaubry/YamlDotNet.git --depth 1

  build:
    windows64:
      - devenv YamlDotNet.sln /build Debug /project YamlDotNet
      - devenv YamlDotNet.sln /build Release-Unsigned /project YamlDotNet

    linux64:
      - xbuild /p:Configuration=Debug YamlDotNet/YamlDotNet.csproj
      - xbuild /p:Configuration=Release-Unsigned YamlDotNet/YamlDotNet.csproj

  install:
     windows64:
      - copytree: [YamlDotNet\bin\Debug, Debug\lib]
      - copytree: [YamlDotNet\bin\Release-Unsigned, Release\lib]

     linux64:
      - copytree: [YamlDotNet/bin/Debug, Debug/lib]
      - copytree: [YamlDotNet/bin/Release-Unsigned, Release/lib]

###############
# MsgPack-cli #
########################################################################################################################
msgpack-cli:
  clone: git clone https://github.com/msgpack/msgpack-cli.git --depth 1

  build:
    windows64:
      - devenv src\MsgPack.Net40\MsgPack.Net40.csproj /build Debug
      - devenv src\MsgPack.Net40\MsgPack.Net40.csproj /build Release

    linux64:
      - xbuild /p:Configuration=Debug src/MsgPack.Net40/MsgPack.Net40.csproj
      - xbuild /p:Configuration=Release src/MsgPack.Net40/MsgPack.Net40.csproj

  install:
     windows64:
      - copytree: [src\MsgPack.Net40\bin\Debug, Debug\lib]
      - copytree: [bin\net40-client, Release\lib]

     linux64:
      - copytree: [src/MsgPack.Net40/bin/Debug, Debug/lib]
      - copytree: [bin/net40-client, Release/lib]

########
# SLD2 #
########################################################################################################################
sdl2:
  platforms: [linux64, darwin64]
  clone: git clone https://github.com/spurious/SDL-mirror.git --depth 1

  build:
    configure: &sdl2_build_configure
      - ./configure
      - make

    configure_darwin: &sdl2_build_configure_darwin
      [./configure --with-x=no, make]

    linux64:  *sdl2_build_configure
    darwin64: *sdl2_build_configure_darwin

  install:
    lib: &sdl2_install_lib
      [build/.libs/libSDL2-2.0.so.0.4.0, Release/lib/libSDL2-2.0.so]

    linux64:
      - copyfile: *sdl2_install_lib

    darwin64:
      - copyfile: *sdl2_install_lib

########
# SLD2 #
########################################################################################################################
sdl2_win_bin:
  platforms: windows64
  clone: download https://www.libsdl.org/release/SDL2-2.0.4-win32-x64.zip SDL2-2.0.4-win32-x64.zip

  build:
    windows64: extract SDL2-2.0.4-win32-x64.zip

  install:
     windows64:
      - copy: [SDL2.dll, Release\lib]

###########
# nanomsg #
########################################################################################################################
nanomsg:
  clone: git clone https://github.com/nanomsg/nanomsg.git --depth 1

  build:
    posix: &nanomsg_build_posix
      [autoreconf -vfi, ./configure, make]

    linux64:  *nanomsg_build_posix
    darwin64: *nanomsg_build_posix
    windows64:
      - cmake .
      - devenv nanomsg.sln /build Release

  install:
    linux64:
      - copyfile: [.libs/libnanomsg.so.4.0.0, Release/lib/libnanomsg.so]

    darwin64:
      - copyfile: [.libs/libnanomsg.so.4.0.0, Release/lib/libnanomsg.so]

    windows64:
      - copy: [Release\nanomsg.dll, Release/lib]

############
# NNanomsg #
########################################################################################################################
nnanomsg:
  clone: git clone https://github.com/OndraVoves/NNanomsg.git --depth 1

  build:
    windows64:
      - devenv NNanomsg.sln /build Debug /project NNanomsg
      - devenv NNanomsg.sln /build Release /project NNanomsg

    linux64:
      - xbuild /p:Configuration=Debug NNanomsg/NNanomsg.csproj
      - xbuild /p:Configuration=Release NNanomsg/NNanomsg.csproj

  install:
     windows64:
      - copytree: [NNanomsg\bin\Release, Release\lib]
      - copytree: [NNanomsg\bin\Debug, Debug\lib]

     linux64:
      - copytree: [NNanomsg/bin/Release, Release/lib]
      - copytree: [NNanomsg/bin/Debug, Debug/lib]

#########
# NSpec #
########################################################################################################################
nspec:
  clone: git clone https://github.com/mattflo/NSpec.git --depth 1

  build:
    windows64:
      - devenv NSpec.sln /build Release

    linux64:
      - xbuild /p:Configuration=Release NSpec/NSpec.csproj
      - xbuild /p:Configuration=Release NSpecRunner/NSpecRunner.csproj

  install:
     windows64:
      - copytree: [NSpec\bin\Release, Release\lib]
      - copytree: [NSpecRunner\bin\Release, Release\bin]

     linux64:
      - copytree: [NSpec/bin/Release, Release/lib]
      - copytree: [NSpecRunner/bin/Release, Release/bin]